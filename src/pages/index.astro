---
import Layout from '../layouts/Layout.astro';

const baseUrl = 'http://localhost:3000'; // Set to your Payload CMS server's URL
const url = `${baseUrl}/api/posts/3?locale=en&draft=false&depth=1`; // Fetch a specific post by ID
const res = await fetch(url);
let post = null; // Default state for a single post

if (res.ok) {
  post = await res.json(); // Directly assign the response data
  console.log('API Response:', post); // Log the entire API response for inspection
} else {
  console.error('Error fetching post:', res.status, await res.text());
}
---

<Layout title={post ? post.title : "Post Not Found"}>
  <h1>Astro + PayloadCMS ðŸš€</h1>
  {post ? (
    <article>
      <h2>{post.title}</h2>
      <p>{post.content}</p>
      <p><strong>Slug:</strong> {post.slug}</p>
      <p><strong>Updated At:</strong> {new Date(post.updatedAt).toLocaleString()}</p>
      <p><strong>Created At:</strong> {new Date(post.createdAt).toLocaleString()}</p>
    </article>
  ) : (
    <p>No post available</p>
  )}
</Layout>

<style>
  /* Add styles here */
</style>
